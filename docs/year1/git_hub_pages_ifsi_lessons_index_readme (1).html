<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lessons IFSI ‚Äî GitHub Pages (IFSI 2025)</title>
  <link rel="stylesheet" href="assets/css/styles.css">
  <style>
    :root{--bg:#f7f9fc;--card:#ffffff;--muted:#6b7280;--accent:#0b5fff}
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background:var(--bg);color:#0b1220}
    .app{display:flex;min-height:100vh}
    nav.sidebar{width:300px;background:transparent;padding:20px;border-right:1px solid rgba(15,20,30,.06);box-sizing:border-box}
    .brand{font-weight:700;color:var(--accent);font-size:16px;margin-bottom:12px}
    .search{display:flex;gap:8px;margin-bottom:12px}
    .search input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(10,20,40,.06);background:linear-gradient(180deg,#fff,#fbfdff)}
    .tree{background:transparent;padding-right:6px}
    .tree h4{margin:12px 0 6px 0;font-size:13px;color:var(--muted)}
    .tree ul{list-style:none;padding-left:8px;margin:0}
    .tree li{margin:6px 0}
    .link{display:flex;align-items:center;gap:8px;padding:8px;border-radius:8px;color:inherit;text-decoration:none}
    .link:hover{background:rgba(11,95,255,0.06)}
    .badge{font-size:12px;color:var(--muted);background:rgba(0,0,0,0.03);padding:4px 8px;border-radius:999px}

    main.viewer{flex:1;padding:28px;box-sizing:border-box}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 20px rgba(12,15,30,0.04);max-width:1100px}
    .viewer-toolbar{display:flex;align-items:center;gap:10px;margin-bottom:12px}
    .btn{padding:8px 10px;border-radius:8px;border:1px solid rgba(10,20,40,.06);background:white;cursor:pointer}
    .btn.primary{background:var(--accent);color:white;border:0}
    iframe.viewer-frame{width:100%;height:72vh;border-radius:8px;border:1px solid rgba(0,0,0,.04);transform-origin:center center;transition: transform 0.2s;}
    .md-content{max-width:900px}
    pre{background:#0b1220;color:#f7f9fc;padding:12px;border-radius:8px;overflow:auto}
    .ue-page{display:flex;flex-direction:column;gap:8px}
    .meta{font-size:13px;color:var(--muted)}
    @media (max-width:900px){nav.sidebar{display:none}main.viewer{padding:12px}}
  </style>
</head>
<body>
  <div class="app">
    <nav class="sidebar">
      <div class="brand">Lessons ‚Äî IFSI 2025</div>
      <div class="search">
        <input id="searchInp" placeholder="Rechercher un fichier ou UE... (ex: anatomie)" />
        <button class="btn" id="refreshBtn">‚Üª</button>
      </div>

      <div class="tree" id="tree">
        <h4>Navigation</h4>
        <div id="menuPlaceholder">
          <p style="color:var(--muted);font-size:13px">Chargement de l'arborescence depuis le d√©p√¥t GitHub...</p>
        </div>
      </div>

      <div style="margin-top:18px;border-top:1px dashed rgba(0,0,0,.04);padding-top:12px">
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn" id="newUE">+ Nouvelle page UE</button>
          <a class="btn" href="README.md" target="_blank">README</a>
        </div>
        <p style="font-size:12px;color:var(--muted);margin-top:8px">Fichiers pris en charge : <span class="badge">.md</span> <span class="badge">.html</span> <span class="badge">.svg</span> <span class="badge">.pdf</span> <span class="badge">.png</span></p>
      </div>
    </nav>

    <main class="viewer">
      <div class="card" id="cardRoot">
        <div class="viewer-toolbar">
          <div style="font-weight:700">Visualiseur</div>
          <div class="meta">&nbsp;‚Äî clique sur un fichier dans la barre lat√©rale pour l'ouvrir</div>
          <div style="margin-left:auto;display:flex;gap:8px">
            <button class="btn" id="zoomIn">üîç+</button>
            <button class="btn" id="zoomOut">üîç-</button>
            <button class="btn" id="rotateBtn">‚Üª</button>
            <button class="btn" id="openNewTab">‚ßâ</button>
            <button class="btn" id="downloadBtn" style="display:none">T√©l√©charger</button>
          </div>
        </div>

        <div id="content">
          <h2>Bienvenue ‚Äî IFSI Lessons (2025)</h2>
          <p class="meta">Acc√®s aux fichiers stock√©s dans <code>/docs</code> de ton d√©p√¥t GitHub <strong>alifsicrip/lessons</strong>. Le menu est g√©n√©r√© automatiquement √† partir du contenu du dossier <code>docs/</code>.</p>
          <p>Le visualiseur supporte : <strong>Markdown (.md)</strong> rendu c√¥t√© client, <strong>HTML</strong> (iframe), <strong>SVG</strong>, <strong>PDF</strong>, et images.</p>
        </div>
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    let scale = 1; let rotation = 0;
    let currentFileUrl = '';
    const viewerFrame = document.querySelector('iframe.viewer-frame');

    function applyTransform(){
      if(viewerFrame){
        viewerFrame.style.transform = `scale(${scale}) rotate(${rotation}deg)`;
      }
    }

    document.getElementById('zoomIn').addEventListener('click', ()=>{scale +=0.1; applyTransform();});
    document.getElementById('zoomOut').addEventListener('click', ()=>{scale -=0.1; if(scale<0.1) scale=0.1; applyTransform();});
    document.getElementById('rotateBtn').addEventListener('click', ()=>{rotation+=90; applyTransform();});
    document.getElementById('openNewTab').addEventListener('click', ()=>{ if(currentFileUrl) window.open(currentFileUrl,'_blank'); });

    // Placeholder: openFile function sets currentFileUrl
    function openFile(url){
      currentFileUrl = url;
      viewerFrame.src = url;
      scale = 1; rotation = 0; applyTransform();
    }
  </script>
</body>
</html>
